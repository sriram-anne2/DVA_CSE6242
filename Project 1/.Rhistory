rel_prop <- data.frame(rel_prop)
plot(rel_prop, type = "n", xlab = "Genre", ylab = "Relative Proportion values")
plot(rel_prop, xlab = "Genre", ylab = "Relative Proportion values")
plot(rel_prop)
pie(rel_prop)
rm(rel_prop)
#relative proportions = total count / number of rows
#taking top 10 genres
rel_prop = (sorted[1:10]) / nrow(df2)
#rel_prop <- data.frame(rel_prop)
pie(rel_prop)
sorted
names(sorted[1:10]
)
for (y in names(sorted[1:10]))
{
assign(y, new_genre[new_genre[, y]==1,])
}
for (y in names(sorted[1:10]))
{
hist(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime" ))
}
for (y in names(sorted[1:10]))
{
hist(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
}
for (y in names(sorted[1:10]))
{
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
}
hist(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
for (y in names(sorted[1:10]))
{
hist(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
}
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
for (y in names(sorted[1:10]))
{
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
}
for (y in names(sorted[1:10]))
{
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), ylab = "Runtime")
}
for (y in names(sorted[1:10]))
{
hist(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
}
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"), xlab = "Runtime")
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"))
# TODO: Plot Runtime distribution for top 10 most common genres
for (y in names(sorted[1:10]))
{
assign(y, new_genre[new_genre[, y]==1,])
}
#assinging a dataframe consisting of each specific genre to each drama for easier plotting
for (y in names(sorted[1:10]))
{
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"))
}
View(new_genre)
# TODO: Remove rows with Year/Date/Released mismatch
time_df <- data.frame(new_genre$Title, new_genre$Year, new_genre$Released, new_genre$Date, new_genre$Gross)
View(time_df)
summary(new_genre$Year)
typeof(new_genre$Released)
names(time_df)
df3 <- new_genre
df3$Released = as.Date(df3$Released, "%Y-%m-%d")
df3$Year_of_Release = as.numeric(format(df3$Released, "%Y"))
bad_data <- df3[(df3$Year == df3$Year_of_Release) | ((df3$Year + 1) == df3$Year_of_Release),]
before = length(df3$Gross[!is.na(df3$Gross)])
before
after = length(bad_data$Gross[!is.na(bad_data$Gross)])
after
percentage = ((before - after)/after) * 100
# TODO: Investigate if Gross Revenue is related to Budget, Runtime or Genre
gross_revenue = subset(new_genre, !is.na(new_genre$Gross))
gross_revenue <- gross_revenue[gross_revenue$Gross != 0, ]
View(gross_revenue)
summary(new_genre$Runtime)
ggplot(gross_revenue, aes(x = log10(Budget), y = log10(Gross))) + geom_point() + geom_line()
ggplot(small_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Shorter Runtime vs Gross Revenue")
small_runtime = subset(gross_revenue, gross_revenue$Runtime < 69) #1st quartile value
long_runtime = subset(gross_revenue, gross_revenue$Runtime > 100) #3rd quartile value
ggplot(small_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Shorter Runtime vs Gross Revenue")
ggplot(long_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Longer Runtime vs Gross Revenue")
ggplot(gross_revenue, aes(x = log10(Budget), y = log10(Gross))) + geom_point() + geom_line() + ggtitle("Budget vs Gross Revenue")
ggplot(small_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Shorter Runtime vs Gross Revenue")
ggplot(long_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Longer Runtime vs Gross Revenue")
bad_data$release_month <- month.abb[release_month]
release_month <- month(as.POSIXct(bad_data$Released, format = "%y-%m-%d"))
install.packages("lubridate")
library(lubridate)
release_month <- month(as.POSIXct(bad_data$Released, format = "%y-%m-%d"))
bad_data$release_month <- month.abb[release_month]
ggplot(bad_data, aes(bad_data$release_month, bad_data$Gross)) +
geom_bar(stat = "identity") + xlab("Released Month") + ylab("Gross Revenue") +
ggtitle("Gross Revenue vs Release Month")
ggplot(bad_data, aes(bad_data$release_month, log10(bad_data$Gross))) +
geom_bar(stat = "identity") + xlab("Released Month") + ylab("Gross Revenue") +
ggtitle("Gross Revenue vs Release Month")
ggplot(bad_data, aes(bad_data$release_month, bad_data$Gross)) +
geom_bar(stat = "identity") + xlab("Released Month") + ylab("Gross Revenue") +
ggtitle("Gross Revenue vs Release Month")
View(new_genre)
View(bad_data)
grepl("Won", new_genre)
View(bad_data)
grepl("Won", new_genre$Awards)
# TODO: Convert Awards to 2 numeric columns: wins and nominations
for (a in c(1:nrow(new_genre)))
{
aw1 = 0
aw2 = 0
if(grepl("Won", new_genre[a, "Awards"])) {
aw1=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Won ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else if(grepl("Nominated",new_genre[a, "Awards"])){
aw2=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Nominated for ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else{
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
new_genre[a,"wins"]=aw1
new_genre[a, "nominations"]=aw2
if(is.na(new_genre[a,"wins"])){new_genre[a,"wins"]=0}
if(is.na(new_genre[a,"nominations"])){new_genre[a,"nominations"]=0}
}
library(stringr)
# TODO: Convert Awards to 2 numeric columns: wins and nominations
for (a in c(1:nrow(new_genre)))
{
aw1 = 0
aw2 = 0
if(grepl("Won", new_genre[a, "Awards"])) {
aw1=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Won ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else if(grepl("Nominated",new_genre[a, "Awards"])){
aw2=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Nominated for ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else{
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
new_genre[a,"wins"]=aw1
new_genre[a, "nominations"]=aw2
if(is.na(new_genre[a,"wins"])){new_genre[a,"wins"]=0}
if(is.na(new_genre[a,"nominations"])){new_genre[a,"nominations"]=0}
}
View(new_genre)
# TODO: Plot Gross revenue against wins and nominations
ggplot(new_genre, aes(x = wins, y = Gross)) + geom_point() + geom_line()
# TODO: Plot Gross revenue against wins and nominations
ggplot(new_genre, aes(x = wins, y = Gross)) + geom_point() + geom_line() + ggtitle("Gross Revenue vs Number of Wins") + xlab("Number of Wins") + ylab("Gross Revenue")
ggplot(new_genre, aes(x = nominations, y = Gross)) + geom_point() + geom_line() + ggtitle("Gross Revenue vs Number of Nomintations") + xlab("Number of Nominations") + ylab("Gross Revenue")
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(imdbrating, tomatometer)) + geom_density()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbrating, y = tomatometer)) + geom_density()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbrating, y = tomatometer)) + geom_density()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_density()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_area()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_point()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_point() + geom_line()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_boxplot()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_violin()
# TODO: Illustrate how ratings from IMDb and Rotten Tomatoes are related
ggplot(new_genre, aes(x = imdbRating, y = tomatoMeter)) + geom_quantile()
ggpairs(new_genre[,c("imdbRating", "imdbVotes", "tomatoMeter", "tomatoRating", "tomatoUserRating", "tomatoFresh")])
# TODO: Show how ratings and awards are related
new_genre$AwardCount <- new_genre$wins + new_genre$nominations
View(new_genre)
ggplot(new_genre, aes(x = imdbRating, y = AwardCount)) + geom_point() + geom_line() + ggtitle("IMDB Ratings vs Number of Awards(wins and nominations)")
# TODO: Show how ratings and awards are related
new_genre$AwardCount <- new_genre$wins + new_genre$nominations
ggplot(new_genre, aes(x = imdbRating, y = AwardCount)) + geom_point() + geom_line() + ggtitle("IMDB Ratings vs Number of Awards(wins and nominations)")
ggplot(new_genre, aes(x = imdbVotes, y = AwardCount)) + geom_point() + geom_line() + ggtitle("IMDB Votes vs Number of Awards(wins and nominations)")
ggplot(new_genre, aes(x = tomatoMeter, y = AwardCount)) + geom_point() + geom_line() + ggtitle("Rotten Tomato's Meter vs Number of Awards(wins and nominations)")
ggplot(new_genre, aes(x = tomatoUserRating, y = AwardCount)) + geom_point() + geom_line() + ggtitle("Rotten Tomato's User's Ratings vs Number of Awards(wins and nominations)")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = Gross)) + geom_point() + geom_line()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = Gross)) + geom_smooth()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_line()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_bar()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_bar(stat = "identity")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_area()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_jitter()
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_boxplot()
qplot(x = Metascore,
y = AwardCount,
data = new_genre)
# TODO: Find and illustrate two expected insights
qplot(x = Metascore,
y = AwardCount,
data = new_genre,
main = "Metascore vs Awards Won/Nominated For") + theme(axis.text.x = element_text(angle = 90))
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(size = 2.5, angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(size = 12, angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(size = 6, angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text( angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
# TODO: Find and illustrate two expected insights
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
summary(new_genre$Metascore)
new_genre$Metascore
ggplot(new_genre, aes(x = Metascore, y = AwardCount)) + geom_boxplot() +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Metascore vs Awards Won/Nominated For")
summary(new_genre$Domestic_Gross)
summary(new_genre$Gross)
#INSIGHT2
#RELATIONSHIP BETWEEN DOMESTIC GROSS AND  GROSS REVENUE
ggplot(new_genre, aes(x = Domestic_Gross, y = Gross)) + geom_point() + geom_line() + ggtitle("Domestic Gross vs Gross Revenue")
# TODO: Find and illustrate one unexpected insight
ggplot(new_genre, aes(x = Budget, y = Gross)) + geom_point() + geom_line() + ggtitle("Relationship with Budget and Gross Revenue")
ggplot(new_genre, aes(x = Budget, y = tomatoRating)) + geom_point() + geom_line() + ggtitle("Relationship between Critic Rating and Budget")
x = 1:10
print(x^2)
plot(x, x^2, 'o')
load('movies_merged')
cat("Dataset has", dim(movies_merged)[1], "rows and", dim(movies_merged)[2], "columns", end="\n", file="")
df = movies_merged
test = movies_merged
cat("Column names:", end="\n", file="")
colnames(df)
install.packages("NLP",dependencies = TRUE)
install.packages('reshape2')
install.packages("tm")
install.packages("ggplot2")
install.packages("GGally")
install.packages("tidyr")
install.packages("SnowballC")
install.packages("lubridate")
library(ggplot2)
library(GGally)
library(tidyr)
library(NLP)
library(tm)
library(plyr)
library(reshape2)
library(SnowballC)
library(lubridate)
library(stringr)
# TODO: Remove all rows from df that do not correspond to movies
df2 <- df[df$Type == "movie",]
dim(df2)
# TODO: Replace df$Runtime with a numeric column containing the runtime in minutes
#NoNarun_time <- df2$Runtime
#NoNarun_time[is.character(NoNarun_time) & NoNarun_time == "N/A"] <- "0 min"
raw_run_time <- df2$Runtime
h_run_time <- as.numeric(gsub(".*?(\\d+) [Hh]r?.*", "\\1", raw_run_time))
h_run_time[is.na(h_run_time)] <- 0
m_run_time <- as.numeric(gsub(".*?(\\d+) [Mm]in?.*", "\\1", raw_run_time))
m_run_time[is.na(m_run_time)] <- 0
run_time <- (h_run_time * 60) + m_run_time
df2$Runtime <- run_time
typeof(df2$Runtime)
# TODO: Investigate the distribution of Runtime values and how it varies by Year and Budget
summary(df2$Year)
summary(df2$Budget)
summary(df2$Runtime)
df2$Period = cut(x = df2$Year, breaks = c(1880, seq(1890,2020, by=10)))
ggplot(df2, aes(x = Period, y = Runtime)) + geom_point() + geom_line() +#geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Runtime VS Year") +
xlab("Years divided into decades") + ylab("Runtime in Min")
df2$Div_runtime = cut(x = df2$Runtime, breaks = c(0, seq(25,875, by=25)))
ggplot(df2, aes(x = Div_runtime, y = Budget)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Runtime VS Budget") +xlab("Runtime in Min") + ylab("Budget in Dollars($)")
# TODO: Replace Genre with a collection of binary columns
summary(df2$Genre)
View(df2)
genre_dictionary <- unique(unlist(strsplit(df2$Genre, ", ")))
genre = data.frame(matrix(nrow = nrow(df2), ncol = length(genre_dictionary)))
colnames(genre) = genre_dictionary
genre[] = 0
for (x in genre_dictionary)
{
genre[grep(x, df2[, "Genre"]), x] = 1
#here we compare each and every genre value to the original dataset and the dictionary,
#searching for x in df2 dataframe$genre, will put 1 if it encounters any of the genres in genre data frame or will put a zero.
#total number of genres is 29, so there will be 29 extra rows.
}
new_genre = cbind(df2, genre)
#final step is to attach the set of binary columns to the original dataframe
# TODO: Select movies from top 10 most common genres and plot their relative proportions
metrics = colSums(genre)
sorted = sort(metrics, decreasing = TRUE)
#relative proportions = total count / number of rows
#taking top 10 genres
rel_prop = (sorted[1:10]) / nrow(df2)
#rel_prop <- data.frame(rel_prop)
pie(rel_prop)
# TODO: Plot Runtime distribution for top 10 most common genres
for (y in names(sorted[1:10]))
{
assign(y, new_genre[new_genre[, y]==1,])
}
#assinging a dataframe consisting of each specific genre to each drama for easier plotting
for (y in names(sorted[1:10]))
{
plot(get(y)[!is.na(get(y)$Runtime), "Runtime"], main = paste("Plot: ", y, " And Runtime"))
}
# TODO: Remove rows with Year/Date/Released mismatch
time_df <- data.frame(new_genre$Title, new_genre$Year, new_genre$Released, new_genre$Date, new_genre$Gross)
df3 <- new_genre
df3$Released = as.Date(df3$Released, "%Y-%m-%d")
df3$Year_of_Release = as.numeric(format(df3$Released, "%Y"))
bad_data <- df3[(df3$Year == df3$Year_of_Release) | ((df3$Year + 1) == df3$Year_of_Release),]
before = length(df3$Gross[!is.na(df3$Gross)])
after = length(bad_data$Gross[!is.na(bad_data$Gross)])
percentage = ((before - after)/after) * 100
# TODO: Investigate if Gross Revenue is related to Budget, Runtime or Genre
gross_revenue = subset(new_genre, !is.na(new_genre$Gross))
gross_revenue <- gross_revenue[gross_revenue$Gross != 0, ]
summary(new_genre$Runtime)
small_runtime = subset(gross_revenue, gross_revenue$Runtime < 69) #1st quartile value
long_runtime = subset(gross_revenue, gross_revenue$Runtime > 100) #3rd quartile value
ggplot(gross_revenue, aes(x = log10(Budget), y = log10(Gross))) + geom_point() + geom_line() + ggtitle("Budget vs Gross Revenue")
install.packages("NLP", dependencies = TRUE)
ggplot(small_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Shorter Runtime vs Gross Revenue")
ggplot(long_runtime, aes(Runtime, Gross)) + geom_point() + geom_line() + ggtitle("Longer Runtime vs Gross Revenue")
# TODO: Investigate if Gross Revenue is related to Release Month
release_month <- month(as.POSIXct(bad_data$Released, format = "%y-%m-%d"))
bad_data$release_month <- month.abb[release_month]
ggplot(bad_data, aes(bad_data$release_month, bad_data$Gross)) +
geom_bar(stat = "identity") + xlab("Released Month") + ylab("Gross Revenue") +
ggtitle("Gross Revenue vs Release Month")
# TODO: Convert Awards to 2 numeric columns: wins and nominations
for (a in c(1:nrow(new_genre)))
{
aw1 = 0
aw2 = 0
if(grepl("Won", new_genre[a, "Awards"])) {
aw1=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Won ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else if(grepl("Nominated",new_genre[a, "Awards"])){
aw2=as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "Nominated for ([\\d]+)"), "[[:digit:]]+"))
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
else{
aw1=aw1+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) win"), "[[:digit:]]+"))
aw2=aw2+as.numeric(str_extract(str_extract(new_genre[a,"Awards"], "([\\d]+) nomination"), "[[:digit:]]+"))
}
new_genre[a,"wins"]=aw1
new_genre[a, "nominations"]=aw2
if(is.na(new_genre[a,"wins"])){new_genre[a,"wins"]=0}
if(is.na(new_genre[a,"nominations"])){new_genre[a,"nominations"]=0}
}
load('movies_merged')
cat("Dataset has", dim(movies_merged)[1], "rows and", dim(movies_merged)[2], "columns", end="\n", file="")
df = movies_merged
test = movies_merged
cat("Column names:", end="\n", file="")
colnames(df)
#install.packages("NLP",dependencies = TRUE)
#install.packages('reshape2')
#install.packages("tm")
#install.packages("ggplot2")
#install.packages("GGally")
#install.packages("tidyr")
#install.packages("SnowballC")
#install.packages("lubridate")
library(ggplot2)
library(GGally)
library(tidyr)
library(NLP)
library(tm)
library(plyr)
library(reshape2)
library(SnowballC)
library(lubridate)
library(stringr)
# TODO: Remove all rows from df that do not correspond to movies
df2 <- df[df$Type == "movie",]
dim(df2)
# TODO: Replace df$Runtime with a numeric column containing the runtime in minutes
#NoNarun_time <- df2$Runtime
#NoNarun_time[is.character(NoNarun_time) & NoNarun_time == "N/A"] <- "0 min"
raw_run_time <- df2$Runtime
h_run_time <- as.numeric(gsub(".*?(\\d+) [Hh]r?.*", "\\1", raw_run_time))
h_run_time[is.na(h_run_time)] <- 0
m_run_time <- as.numeric(gsub(".*?(\\d+) [Mm]in?.*", "\\1", raw_run_time))
m_run_time[is.na(m_run_time)] <- 0
run_time <- (h_run_time * 60) + m_run_time
df2$Runtime <- run_time
typeof(df2$Runtime)
df2 <- df2[!is.na(df2$Gross),]
df2 <- df2[df2$Year > 2000,]
colnames(df2)
df2 <- subset(df2, select = -c(Poster,Metascore,imdbRating, imdbVotes, imdbID, Type, tomatoMeter, tomatoImage, tomatoRating, tomatoReviews, tomatoFresh, tomatoRotten, tomatoConsensus, tomatoUserMeter, tomatoUserRating, tomatoUserReviews, tomatoURL, DVD, BoxOffice, Website, Response, Budget, Domestic_Gross, Gross))
colnames(df2)
# TODO: Replace Genre with a collection of binary columns
summary(df2$Genre)
View(df2)
genre_dictionary <- unique(unlist(strsplit(df2$Genre, ", ")))
genre = data.frame(matrix(nrow = nrow(df2), ncol = length(genre_dictionary)))
colnames(genre) = genre_dictionary
genre[] = 0
for (x in genre_dictionary)
{
genre[grep(x, df2[, "Genre"]), x] = 1
#here we compare each and every genre value to the original dataset and the dictionary,
#searching for x in df2 dataframe$genre, will put 1 if it encounters any of the genres in genre data frame or will put a zero.
#total number of genres is 29, so there will be 29 extra rows.
}
new_genre = cbind(df2, genre)
#final step is to attach the set of binary columns to the original dataframe
x = 1:10
print(x^2)
plot(x, x^2, 'o')
load('movies_merged')
cat("Dataset has", dim(movies_merged)[1], "rows and", dim(movies_merged)[2], "columns", end="\n", file="")
df = movies_merged
test = movies_merged
cat("Column names:", end="\n", file="")
colnames(df)
#install.packages("NLP",dependencies = TRUE)
#install.packages('reshape2')
#install.packages("tm")
#install.packages("ggplot2")
#install.packages("GGally")
#install.packages("tidyr")
#install.packages("SnowballC")
#install.packages("lubridate")
library(ggplot2)
library(GGally)
library(tidyr)
library(NLP)
library(tm)
library(plyr)
library(reshape2)
library(SnowballC)
library(lubridate)
library(stringr)
# TODO: Remove all rows from df that do not correspond to movies
df2 <- df[df$Type == "movie",]
dim(df2)
# TODO: Replace df$Runtime with a numeric column containing the runtime in minutes
#NoNarun_time <- df2$Runtime
#NoNarun_time[is.character(NoNarun_time) & NoNarun_time == "N/A"] <- "0 min"
raw_run_time <- df2$Runtime
h_run_time <- as.numeric(gsub(".*?(\\d+) [Hh]r?.*", "\\1", raw_run_time))
h_run_time[is.na(h_run_time)] <- 0
m_run_time <- as.numeric(gsub(".*?(\\d+) [Mm]in?.*", "\\1", raw_run_time))
m_run_time[is.na(m_run_time)] <- 0
run_time <- (h_run_time * 60) + m_run_time
df2$Runtime <- run_time
typeof(df2$Runtime)
# TODO: Investigate the distribution of Runtime values and how it varies by Year and Budget
summary(df2$Year)
summary(df2$Budget)
summary(df2$Runtime)
df2$Period = cut(x = df2$Year, breaks = c(1880, seq(1890,2020, by=10)))
ggplot(df2, aes(x = Period, y = Runtime)) + geom_point() + geom_line() +#geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Runtime VS Year") +
xlab("Years divided into decades") + ylab("Runtime in Min")
df2$Div_runtime = cut(x = df2$Runtime, breaks = c(0, seq(25,875, by=25)))
ggplot(df2, aes(x = Div_runtime, y = Budget)) + geom_point() + geom_line() +
theme(axis.text.x = element_text(angle = 90)) + ggtitle("Runtime VS Budget") +xlab("Runtime in Min") + ylab("Budget in Dollars($)")
df2 <- df2[!is.na(df2$Gross),]
df2 <- df2[df2$Year > 2000,]
colnames(df2)
df2 <- subset(df2, select = -c(Poster,Metascore,imdbRating, imdbVotes, imdbID, Type, tomatoMeter, tomatoImage, tomatoRating, tomatoReviews, tomatoFresh, tomatoRotten, tomatoConsensus, tomatoUserMeter, tomatoUserRating, tomatoUserReviews, tomatoURL, DVD, BoxOffice, Website, Response, Budget, Domestic_Gross, Gross))
# TODO: Replace Genre with a collection of binary columns
df2_na <- na.omit(df2)
df_nagenre<-df2_na
nagenre<-df_nagenre$Genre
temp_crpus = Corpus(VectorSource(df_nagenre$Genre))
temp_crpus <- tm_map(temp_crpus, stripWhitespace)
temp_crpus <- tm_map(temp_crpus, tolower)
temp_crpus <- tm_map(temp_crpus, removePunctuation)
temp_crpus <- tm_map(temp_crpus, PlainTextDocument)
tm_map(temp_crpus, stemDocument, language="english")
genre_dict <- DocumentTermMatrix(temp_crpus)
setwd("C:/Users/user/Downloads/pr2")
